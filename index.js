/* *
   * bt-to 
   * @description Cloudflare Worker that fetches the current agenda from bundestag.de, saves it in a KV database and serves it as an API.
   * @author Jannis Hutt
   * @url https://api.hutt.io/bt-to/
   * @lastEdit 2024-05-20
   *
*/

import cheerio from "cheerio";

// Event Listener fÃ¼r eingehende Anfragen und geplante Aufgaben
addEventListener("fetch", (event) => {
    event.respondWith(handleRequest(event));
});

addEventListener("scheduled", (event) => {
    event.waitUntil(updateAgenda());
});

// Hauptfunktion zur Verarbeitung eingehender Anfragen
async function handleRequest(event) {
    const request = event.request;
    const url = new URL(request.url);
    const path = url.pathname;
    const params = url.searchParams;

    let response;

    if (path === "/bt-to/" || path === "/bt-to") {
        response = await serveDocumentation();
    } else if (path === "/bt-to/data-list") {
        response = await serveDataList(request);
    } else if (path === "/bt-to/ical" || path === "/bt-to/ics") {
        response = await serveAgenda("ical", params);
    } else if (path === "/bt-to/json") {
        response = await serveAgenda("json", params);
    } else if (path === "/bt-to/xml") {
        response = await serveAgenda("xml", params);
    } else if (path === "/bt-to/csv") {
        response = await serveAgenda("csv", params);
    } else {
        response = new Response("Not Found", { status: 404 });
    }

    return response;
}

// Dokumentationsseite der API bereitstellen
async function serveDocumentation() {
    const html = `
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bundestag Tagesordnung API</title>
    <meta name="keywords" content="Bundestag, Parlament, Tagesordnung, Sitzungsverlauf, API, Kalender, iCal, Feed, JSON, XML, CSV, Export, maschinenlesbar, Kalenderabo">
    <meta name="description" content="Endlich maschinenlesbar und als Kalender-Feed: Die Tagesordnung des Bundestages.">
    
    <meta property="og:title" content="Bundestags-TO API">
    <meta property="og:url" content="http://api.hutt.io/bt-to/">
    <meta property="og:image" content="https://raw.githubusercontent.com/hutt/bt-to/main/bt-to-api.png">
    <!--
        <meta property="og:image" content="data:image/png;base64,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">
    -->
    <meta property="og:description" content="Endlich maschinenlesbar und als Kalender-Feed: Die Tagesordnung des Bundestages.">
    <meta property="og:type" content="website">
    
    <meta name="twitter:card" content="summary">
    <meta property="twitter:title" content="Bundestags-TO API">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/hutt/bt-to/main/bt-to-api.png">
    <!--
        <meta name="twitter:image" content="data:image/png;base64,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">
    -->
    <meta property="twitter:description" content="Endlich maschinenlesbar und als Kalender-Feed: Die Tagesordnung des Bundestages.">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        header {
            background-color: #0a4445;
            color: white;
            text-align: center;
            padding: 20px 0;
        }
        h1 {
            font-size: 2em;
            margin: 0;
        }
        h2 {
            font-size: 1.7em;
            color: #0a4445;
            margin-top: 2.5rem;
            margin-bottom: 0;
        }
        main > section:first-child > h2 {
            margin-top: 0;
        }
        h3 {
            font-size: 1.5em;
            font-weight: 400;
            color: #333333;
            margin-top: 1.6rem;
            margin-bottom: 0;
        }
        main {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        ul {
            list-style-type: disc;
            padding-left: 20px;
        }
        li {
            margin-bottom: 10px;
        }
        li ul {
            padding-left: 20px;
            margin-top: 10px;
            margin-bottom: 20px;
        }
        ul.data {
            list-style-type: none;
        }
        a {
            color: #0a4445;
            text-decoration: none;
            border-bottom: 1px dotted;
        }
        a:hover {
            text-decoration: none;
            border-bottom: 1px solid;
        }
        a.buy-me-a-coffee, a.buy-me-a-coffee:hover {
            text-decoration: none;
            border-bottom: none;
        }
        strong {
            font-weight: 600;
        }
        code {
            background-color: #e8e8e8;
            padding: 2px 4px;
            border-radius: 4px;
        }
        pre {
            background-color: #e8e8e8;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        footer {
            text-align: center;
            margin-top: 20px;
            margin-bottom: 20px;
            padding: 10px;
            font-size: 0.8em;
            color: #777;
        }
        @media (max-width: 800px) {
            main {
                margin: 1rem;
                padding: 15px;
            }
            footer {
                font-size: 0.6em;
            }
        }
    </style>
</head>
<body>

<header>
    <h1>Bundestag Tagesordnung</h1>
    <p>Inoffizielle iCal-, JSON-, XML- und CSV-API.</p>
</header>

<main>
    <section id="hintergrund">
        <h2>Hintergrund</h2>
        <p>Der Deutsche Bundestag stellt seine Tagesordnung <a href="https://www.bundestag.de/tagesordnung">online zur VerfÃ¼gung</a> &ndash; nur leider in keinem maschinenlesbaren Format. Da in Sitzungswochen mindestens 734 AbgeordnetenbÃ¼ros hÃ¤ndisch die Tagesordnungspunkte in ihren Kalendern aktualisieren mÃ¼ssen, war es Zeit fÃ¼r eine Alternative.</p>
        <p>Aus diesem Grund stelle ich (ein einfacher MdB-Mitarbeiter) mithilfe eines Cloudflare-Workers diese API bereit, die die aktuelle Tagesordnung von der Website des Deutschen Bundestags scraped und in einer Key-Value-Datenbank zwischenspeichert.</p>
        <p>Die Tagesordnungspunkte fÃ¼r die laufenden Sitzungswoche werden alle 15min aktualisiert. AuÃerdem kÃ¶nnen die <a href="#vorhandene-daten">Tagesordnungen vergangener Sitzungswochen oder gleich ganzer Jahre</a> abgefragt oder heruntergeladen werden.</p>
        <p>Falls etwas nicht funktioniert, wie es soll: Nicht wundern, das Projekt ist in der <strong>Beta-Phase</strong>. Ich freue mich Ã¼ber einen freundlichen Hinweis (<a href="#quellcode">*klick*</a>).</p>
    </section>

    <section id="feed-abonnieren">
        <h2>Kalenderfeed abonnieren</h2>
        <p>Um die &ndash; in Sitzungswochen alle 15min aktualisiserten &ndash; Tagesordnungen des laufenden Jahres als iCal-Feed zu abonnieren, kann folgende URL verwendet werden: <code>https://api.hutt.io/bt-to/ical</code>.</p>
        <p>Neben <strong>Startzeit, TOP und Thema</strong> enthalten die KalendereintrÃ¤ge auÃerdem <strong>aktuelle Informationen zum Status des Tagesordnungspunktes</strong>, den etwas ausfÃ¼hrlicheren <strong>Beschreibungstext</strong> und, falls vorhanden, einen <strong>Link zum zugehÃ¶rigen Artikel</strong> im bundestag.de-Textearchiv.</p>
        <p>Aus Performance-GrÃ¼nden enthÃ¤lt dieses Feed <em>nicht</em> die Tagesordnungen vergangener Kalenderjahre. Sie kÃ¶nnen mit dieser API allerdings auch abgefragt oder <a href="#vorhandene-daten">hÃ¤ndisch heruntergeladen</a> werden.</p>
        <h3>Outlook (Windows)</h3>
        <ol>
            <li>Ãffnen Sie Ihren Outlook-Kalender, und wÃ¤hlen Sie auf der Registerkarte Start die Option <strong>Kalender hinzufÃ¼gen > Aus dem Internet</strong> aus.
            <li>FÃ¼gen Sie die URL <code>https://api.hutt.io/bt-to/ical</code> ein und klicken Sie auf <strong>OK</strong>.</li>
            <li>Outlook fragt, ob Sie diesen Kalender hinzufÃ¼gen und Updates abonnieren mÃ¶chten. WÃ¤hlen Sie <strong>Ja</strong> aus.</li>
        </ol>
        <h3>Thunderbird</h3>
        <ol>
            <li>Ãffnen Sie Thunderbird und wÃ¤hlen Sie <strong>Datei > Neu > Kalenderâ¦</strong></li>
            <li>WÃ¤hlen Sie Im Netzwerk und klicken Sie auf <strong>Weiter</strong>.</li>
            <li>WÃ¤hlen Sie in der âFormatâ-Liste den Auswahlknopf <strong>iCalendar (ICS)</strong>.</li>
            <li>FÃ¼gen Sie den Link <code>https://api.hutt.io/bt-to/ical</code> in das Feld neben âAdresseâ ein. Klicken Sie danach auf <strong>Weiter</strong>.</li>
            <li>Klicken Sie auf <strong>Fertigstellen</strong>.</li>
        </ol>
        <h3>iOS Kalender-App</h3>
        <ol>
            <li>Ãffnen Sie die <strong>Einstellungen</strong>-App.</li>
            <li>Tippen Sie auf <strong>âAccounts & PasswÃ¶rterâ</strong>, wÃ¤hlen Sie <strong>âAccount hinzufÃ¼genâ</strong>, dann <strong>âAndereâ</strong> aus.</li>
            <li>FÃ¼gen Sie ein <strong>neues âKalenderaboâ</strong> mit der URL <code>https://api.hutt.io/bt-to/ical</code> hinzu.</li>
        </ol>
        <h3>macOS Kalender-App</h3>
        <ol>
            <li>Ãffnen Sie die <strong>Kalender</strong>-App.</li>
            <li>Gehen Sie in der MenÃ¼leiste zu <strong>âDateiâ > âNeues Kalenderabonnementâ</strong>.</li>
            <li>FÃ¼gen Sie nun den Link <code>https://api.hutt.io/bt-to/ical</code> ein und klicken Sie auf <strong>âAbonnierenâ</strong>.</li>
        </ol>
    </section>

    <section id="api-endpoints">
        <h2>API Endpoints</h2>
        <p>GET-Parameter, die fÃ¼r Abfragen genutzt werden kÃ¶nnen:</p>
        <ul>
            <li><code>year</code>: Das Jahr, fÃ¼r das die Tagesordnungen geholt werden sollen (optional)</li>
            <li><code>week</code>: Die Kalenderwoche, fÃ¼r die die Tagesordnungen geholt werden sollen (optional; mit <code>year</code> kombinierbar)</li>
        </ul>

        <h3>iCal / ICS</h3>
        <p>Beispiel-Request:</p>
        <pre><code>GET https://api.hutt.io/bt-to/ical</code></pre>
        <p>Beispiel-Antwort:</p>
        <pre><code class="hljs" data-lang="text">BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//hutt.io//api.hutt.io/bt-to//
CALSCALE:GREGORIAN
X-WR-TIMEZONE:Europe/Berlin
X-WR-CALNAME:Tagesordnung Bundestag
DESCRIPTION:Dieses iCal-Feed stellt die aktuelle Tagesordnung des Plen
ums des Deutschen Bundestages zur VerfÃ¼gung. Es aktualisiert sich alle
 15min selbst. Zwar ist der Sitzungsverlauf auch online unter bundesta
g.de/tagesordnung einsehbar, doch leider werden diese Daten nicht in e
inem maschinenlesbaren Format zur VerfÃ¼gung gestellt. Deshalb war es Z
eit, das selbst in die Hand zu nehmen. Mehr Informationen Ã¼ber das Pro
jekt: https://api.hutt.io/bt-to/.
SOURCE;VALUE=URI:https://api.hutt.io/bt-to/ical
COLOR:#808080
BEGIN:VTIMEZONE
TZID:Europe/Berlin
BEGIN:STANDARD
TZNAME:CET
DTSTART:19701025T030000
TZOFFSETFROM:+0200
TZOFFSETTO:+0100
RRULE:FREQ=YEARLY;BYMONTH=10;BYDAY=-1SU
END:STANDARD
BEGIN:DAYLIGHT
TZNAME:CEST
DTSTART:19700329T020000
TZOFFSETFROM:+0100
TZOFFSETTO:+0200
RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=-1SU
END:DAYLIGHT
END:VTIMEZONE
[â¦]
BEGIN:VEVENT
UID:1715777400000-fragestunde-top-2@api.hutt.io
DTSTAMP:20240521T100025Z
DTSTART;TZID=Europe/Berlin:20240515T125000
DTEND;TZID=Europe/Berlin:20240515T133500
SUMMARY:TOP 2: Fragestunde
DESCRIPTION:Status: beendet\n\nFragestunde\nDrucksache 20/11319, 20/11
340
URL:https://bundestag.de/dokumente/textarchiv/2024/kw20-de-fragestunde
-999696
END:VEVENT
BEGIN:VEVENT
UID:1715780100000-aktuelle-stunde:-kernkraft-aus---vorgÃ¤nge-um-bm-habe
ck-und-bmn-lemke-zp-1@api.hutt.io
DTSTAMP:20240521T100025Z
DTSTART;TZID=Europe/Berlin:20240515T133500
DTEND;TZID=Europe/Berlin:20240515T150000
SUMMARY:ZP 1: Aktuelle Stunde: Kernkraft-Aus - VorgÃ¤nge um BM Habeck u
nd BMn Lemke
DESCRIPTION:Status: beendet\n\nAktuelle Stunde\nauf Verlangen der Frak
tion der CDU/CSU\nKernkraft-Aus â VorgÃ¤nge um Bundesminister Habeck un
d Bundesministerin Lemke transparent aufklÃ¤ren
URL:https://bundestag.de/dokumente/textarchiv/2024/kw20-de-aktuelle-st
unde-kernkraft-1002698
END:VEVENT
[â¦]
END:VCALENDAR</code></pre>

        <h3>JSON</h3>
        <p>Beispiel-Request:</p>
        <pre><code>GET https://api.hutt.io/bt-to/json</code></pre>
        <p>Beispiel-Antwort:</p>
        <pre><code class="hljs" data-lang="json">[
    [â¦]
    {
        "start":"2024-05-15T14:50:00.000",
        "end":"2024-05-15T15:35:00.000",
        "top":"TOP 2",
        "thema":"Fragestunde",
        "beschreibung":"Status: beendet\n\nFragestunde\nDrucksache 20/11319, 20/11340",
        "url":"https://bundestag.de/dokumente/textarchiv/2024/kw20-de-fragestunde-999696",
        "status":"beendet",
        "uid":"1715784600000-fragestunde-top-2@api.hutt.io",
        "dtstamp":"2024-05-21T11:09:37.775Z"
    },
    [â¦]
]</code></pre>

        <h3>XML</h3>
        <p>Beispiel-Request:</p>
        <pre><code>GET https://api.hutt.io/bt-to/xml</code></pre>
        <p>Beispiel-Antwort:</p>
        <pre><code class="hljs" data-lang="xml">&lt;agenda&gt;
    [â¦]
    &lt;event&gt;
        &lt;start&gt;2024-05-15T14:50:00.000&lt;/start&gt;
        &lt;end&gt;2024-05-15T15:35:00.000&lt;/end&gt;
        &lt;top&gt;TOP 2&lt;/top&gt;
        &lt;thema&gt;Fragestunde&lt;/thema&gt;
        &lt;status&gt;beendet&lt;/status&gt;
        &lt;beschreibung&gt;Status: beendet Fragestunde Drucksache 20/11319, 20/11340&lt;/beschreibung&gt;
        &lt;url&gt;https://bundestag.de/dokumente/textarchiv/2024/kw20-de-fragestunde-999696&lt;/url&gt;
    &lt;/event&gt;
    [â¦]
&lt;/agenda&gt;</code></pre>

        <h3>CSV</h3>
        <p>Beispiel-Request:</p>
        <pre><code>GET https://api.hutt.io/bt-to/csv</code></pre>
        <p>Beispiel-Antwort:</p>
        <pre><code class="hljs" data-lang="csv">Start;Ende;TOP;Thema;Beschreibung;URL;Status
[...]
2024-05-15T14:50:00.000;2024-05-15T15:35:00.000;TOP 2;Fragestunde;"Status: beendet

Fragestunde
Drucksache 20/11319, 20/11340";https://bundestag.de/dokumente/textarchiv/2024/kw20-de-fragestunde-999696;beendet
[...]</code></pre>
    </section>

    <section id="vorhandene-daten">
        <h2>Vorhandene Daten</h2>
        <p>Hier sind die mit dieser API abrufbaren Daten inkl. Links zum direkten Download aufgelistet. Aktuell sind Abfragen auf DatensÃ¤tze ab 2020 begrenzt.</p>
        <ul id="data-list" class="data">
            <li><svg width="12" height="12" stroke="#000" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><style>.spinner_V8m1{transform-origin:center;animation:spinner_zKoa 2s linear infinite}.spinner_V8m1 circle{stroke-linecap:round;animation:spinner_YpZS 1.5s ease-in-out infinite}@keyframes spinner_zKoa{100%{transform:rotate(360deg)}}@keyframes spinner_YpZS{0%{stroke-dasharray:0 150;stroke-dashoffset:0}47.5%{stroke-dasharray:42 150;stroke-dashoffset:-16}95%,100%{stroke-dasharray:42 150;stroke-dashoffset:-59}}</style><g class="spinner_V8m1"><circle cx="12" cy="12" r="9.5" fill="none" stroke-width="3"></circle></g></svg> Daten werden geladen...</li>
        </ul>
    </section>

    <section id="quellcode">
        <h2>Quellcode und Weiterentwicklung</h2>
        <p>Das Projekt ist <a href="https://github.com/hutt/bt-to/blob/main/LICENSE.md">unter MIT lizensiert</a> und damit <strong>Open Source</strong>. Wer sich den Quellcode ansehen oder dazu beitragen mÃ¶chte, findet die <strong>Repository dieses Projekts <a href="https://github.com/hutt/bt-to">auf GitHub</a></strong>.</p>
        <p>Die Entwicklung weiterer Funktionen, unter anderem von Themen- bzw. AusschusszugehÃ¶rigkeits-Filtern ist geplant. Da dieses Projekt nur ein Hobby ist, kann aber nicht gesagt werden, wie schnell das geht.</p>
        <p>Sie haben Fehler zu berichten oder Ideen fÃ¼r die Weiterentwicklung? <a href="https://hutt.io/#kontakt">Hier kÃ¶nnen Sie mich kontaktieren</a>.</p>
    </section>

    <section id="unterstuetzen">
        <h2>UnterstÃ¼tzen</h2>
        <p>In solche Projekte flieÃt eine Menge Zeit und meistens auch ein bisschen Geld fÃ¼rs Hosting. Wenn Sie die (Weiter-)Entwicklung und den Betrieb unterstÃ¼tzen wollen (worÃ¼ber ich mich sehr freue), kÃ¶nnen Sie mir Ã¼ber den Link unten einen (digitalen) Kaffee kaufen.</p>
        <p>Vielen Dank!</p>
        <p><a class="buy-me-a-coffee" href="https://www.buymeacoffee.com/jannishutt" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;" ></a></p>
    </section>
</main>

<footer>
    Copyright &copy; 2024 <a href="https://hutt.io">Jannis Hutt</a> | <a href="https://hutt.io/datenschutz.html">Datenschutz</a> | <a href="https://hutt.io/#impressum">Impressum</a>
</footer>

<script>
    document.addEventListener("DOMContentLoaded", async () => {
        const response = await fetch("/bt-to/data-list");
        const kvData = await response.json();
        const dataListElement = document.getElementById("data-list");

        const years = Object.keys(kvData).sort((a, b) => b - a); // Jahre absteigend sortieren
        let dataListHtml = '';

        years.forEach(year => {
            const weeks = kvData[year].filter(week => week).sort((a, b) => a - b); // Wochen pro Jahr aufsteigend sortieren und leere Objekte herausfiltern
            let weeksHtml = '';
            if (weeks.length === 0) {
                weeksHtml = '<li>keine Daten</li>';
            } else {
                weeks.forEach(week => {
                    weeksHtml += \`
                        <li>Kalenderwoche \${week} 
                            (<a href="/bt-to/ical?year=\${year}&week=\${week}">iCal</a> | 
                            <a href="/bt-to/json?year=\${year}&week=\${week}">JSON</a> | 
                            <a href="/bt-to/xml?year=\${year}&week=\${week}">XML</a> | 
                            <a href="/bt-to/csv?year=\${year}&week=\${week}">CSV</a>)
                        </li>\`;
                });
            }

            const yearLinks = weeks.length >= 1 ? \` 
                (<a href="/bt-to/ical?year=\${year}">iCal</a> | 
                <a href="/bt-to/json?year=\${year}">JSON</a> | 
                <a href="/bt-to/xml?year=\${year}">XML</a> | 
                <a href="/bt-to/csv?year=\${year}">CSV</a>)\` : '';

            dataListHtml += \`<li><strong>\${year}</strong>\${yearLinks}<ul class="data">\${weeksHtml}</ul></li>\`;
        });

        dataListElement.innerHTML = dataListHtml;
    });
</script>

</body>
</html>
`;

    return new Response(html, {
        headers: { "content-type": "text/html; charset=UTF-8" }
    });
}

// Liste mit gecachten Daten bereitstellen
async function serveDataList(request) {
    // Cache-Zeit fÃ¼r Daten aus KV Storage
    const cacheDuration = 15 * 60; // 15 min in Sekunden

    const cache = caches.default;
    const cacheKey = new Request(new URL(request.url).toString());

    // Versuchen, Antwort aus dem Cache zu laden.
    let cachedResponse = await cache.match(cacheKey);
    if (cachedResponse) {
        return cachedResponse;
    }

    // Wenn nicht im Cache, aus dem KV Storage laden.
    let kvData = {};
    const currentYear = new Date().getFullYear();
    const currentWeek = getWeekNumber(new Date());

    const fetchYearData = async (year) => {
        let yearData = [];
        let weekPromises = [];

        for (let week = 1; week <= 52; week++) {
            weekPromises.push(data.get(`agenda-${year}-${week}`, { type: "json" }).then(dataItem => {
                if (dataItem && Object.keys(dataItem).length > 0) {
                    if ((year < currentYear) || (year === currentYear && week <= currentWeek)){
                        yearData.push(week);
                    }
                }
            }));
        }

        await Promise.all(weekPromises);
        return { year, weeks: yearData };
    };

    let yearPromises = [];
    for (let year = currentYear; year >= 2020; year--) { // Daten vor 2020 nicht laden
        yearPromises.push(fetchYearData(year));
    }

    const yearDataArray = await Promise.all(yearPromises);

    yearDataArray.forEach(yearData => {
        kvData[yearData.year] = yearData.weeks;
    });

    // Geholte Daten cachen
    const response = new Response(JSON.stringify(kvData), {
        headers: { 'Content-Type': 'application/json' }
    });
    response.headers.append('Cache-Control', `max-age=${cacheDuration}`);
    await cache.put(cacheKey, response.clone());

    return response;
}

// Funktion zur Bereitstellung der Tagesordnung in verschiedenen Formaten
async function serveAgenda(format, params) {
    const year = params.get('year') || new Date().getFullYear();
    const week = params.get('week');
    const month = params.get('month');
    const day = params.get('day');
    const status = params.get('status');

    const currentWeek = getWeekNumber(new Date());
    const currentYear = new Date().getFullYear();

    if (year > currentYear || (year == currentYear && week > currentWeek)) {
        return new Response("Keine Daten fÃ¼r zukÃ¼nftige Wochen", { status: 400 });
    }

    let agendaItems = [];
    if (week) {
        agendaItems = await getOrFetchAgendaByWeek(year, week);
    } else if (month) {
        agendaItems = await getOrFetchAgendaByMonth(year, month);
    } else if (day) {
        agendaItems = await getOrFetchAgendaByDay(year, month, day);
    } else {
        agendaItems = await getOrFetchAgendaByYear(year);
    }

    // Filter nach Status
    if (status) {
        agendaItems = agendaItems.filter(item => item.status && item.status.includes(status));
    }

    return formatAgendaResponse(format, agendaItems);
}

// Tagesordnung per Cronjob (alle 15min) aktualisieren.
async function updateAgenda() {
    const year = new Date().getFullYear();
    const week = getWeekNumber(new Date());
    const html = await fetchAgenda(year, week);
    const newAgendaItems = await parseAgenda(html);

    // Bereits existierende Tagesordnungspunkte aus KV Storage holen
    const currentItemsRaw = await data.get(`agenda-${year}-${week}`, { type: "json" });

    // ÃberprÃ¼fen, ob die Daten vorhanden und gÃ¼ltig sind
    let currentItemsArray = [];
    if (currentItemsRaw) {
        try {
            if (currentItemsRaw.trim().length > 0) {
                currentItemsArray = JSON.parse(currentItemsRaw);
            }
        } catch (e) {
            console.error("Failed to parse currentItemsRaw:", e);
            currentItemsArray = [];
        }
    }

    // Neue und aktualisierte Items in KV Storage speichern
    const updatedItems = newAgendaItems.map(newItem => {
        const currentItem = currentItemsArray.find(item => item.uid === newItem.uid);
        if (currentItem) {
            // ÃberprÃ¼fen, ob es Ãnderungen gibt
            if (JSON.stringify(currentItem) !== JSON.stringify(newItem)) {
                return newItem;
            } else {
                return currentItem;
            }
        } else {
            return newItem;
        }
    });

    // Nur neue oder geÃ¤nderte Items speichern
    if (updatedItems.length > 0) {
        await data.put(`agenda-${year}-${week}`, JSON.stringify(updatedItems));
    }
}

// Funktionen zum Abrufen oder Abrufen und Speichern der Tagesordnung
async function getOrFetchAgendaByWeek(year, week) {
    const currentDate = new Date();
    const currentYear = currentDate.getFullYear();
    const currentWeek = getWeekNumber(currentDate);

    // ÃberprÃ¼fen, ob die angeforderte Woche in der Zukunft liegt
    if (year > currentYear || (year === currentYear && week > currentWeek)) {
        return [];
    }

    let agendaItems = await data.get(`agenda-${year}-${week}`, { type: "json" });
    if (!agendaItems) {
        await fetchAndStoreAgenda(year, week);
        agendaItems = await data.get(`agenda-${year}-${week}`, { type: "json" });
    } else {
        //console.log(`Loaded Items for week ${week} in year ${year} from KV database: ${agendaItems}`);
    }
    return agendaItems;
}

async function getOrFetchAgendaByMonth(year, month) {
    let agendaItems = [];
    const weeksInMonth = getWeeksInMonth(year, month);
    for (const week of weeksInMonth) {
        const weekItems = await getOrFetchAgendaByWeek(year, week);
        agendaItems = agendaItems.concat(weekItems);
    }
    return agendaItems;
}

async function getOrFetchAgendaByDay(year, month, day) {
    const week = getWeekNumber(new Date(year, month - 1, day));
    const weekItems = await getOrFetchAgendaByWeek(year, week);
    return weekItems.filter(item => new Date(item.start).getDate() === day);
}

async function getOrFetchAgendaByYear(year) {
    let agendaItems = [];
    const currentDate = new Date();
    const currentWeek = getWeekNumber(currentDate);

    for (let week = 1; week <= (year === currentDate.getFullYear() ? currentWeek : 52); week++) {
        const weekItems = await getOrFetchAgendaByWeek(year, week);
        agendaItems = agendaItems.concat(weekItems);
    }
    return agendaItems;
}

// Wochen in einem Monat ermitteln
function getWeeksInMonth(year, month) {
    const weeks = new Set();
    const firstDay = new Date(year, month - 1, 1);
    const lastDay = new Date(year, month, 0);

    for (let day = firstDay; day <= lastDay; day.setDate(day.getDate() + 1)) {
        weeks.add(getWeekNumber(new Date(day)));
    }

    return Array.from(weeks);
}

// Antwortformatierung je nach Anforderung (ical, json, xml, csv)
function formatAgendaResponse(format, agendaItems) {
    let data;
    let contentType;

    if (format === "ical") {
        data = createIcal(agendaItems);
        contentType = "text/calendar; charset=utf-8";
    } else if (format === "json") {
        data = JSON.stringify(agendaItems);
        contentType = "application/json; charset=utf-8";
    } else if (format === "xml") {
        data = createXml(agendaItems);
        contentType = "application/xml; charset=utf-8";
    } else if (format === "csv") {
        data = createCsv(agendaItems);
        contentType = "text/csv; charset=utf-8";
    }

    return new Response(data, {
        headers: { "content-type": contentType },
    });
}

// Tagesordnung fÃ¼r eine bestimmte Woche abrufen und speichern
async function fetchAndStoreAgenda(year, week) {
    const currentDate = new Date();
    const currentYear = currentDate.getFullYear();
    const currentWeek = getWeekNumber(currentDate);

    // ÃberprÃ¼fen, ob die angeforderte Woche in der Zukunft liegt
    if (year > currentYear || (year === currentYear && week > currentWeek)) {
        return;
    }

    const html = await fetchAgenda(year, week);
    const newAgendaItems = await parseAgenda(html);
    await data.put(`agenda-${year}-${week}`, JSON.stringify(newAgendaItems));
    //console.log(`New Items fetched for week ${week} in year ${year}: ${JSON.stringify(newAgendaItems)}.`);
}

// Abrufen der Tagesordnung von der Bundestags-Website
async function fetchAgenda(year, week) {
    const response = await fetch(
        `https://www.bundestag.de/apps/plenar/plenar/conferenceweekDetail.form?year=${year}&week=${week}`,
    );
    if (!response.ok) {
        throw new Error("Failed to fetch agenda");
    }
    return await response.text();
}

// Tagesordnung von HTML zu JSON parsen
async function parseAgenda(html) {
    const $ = cheerio.load(html);
    const tables = $("table.bt-table-data");
    const agendaItems = [];
    const months = {
        Januar: 0, Februar: 1, MÃ¤rz: 2, April: 3, Mai: 4, Juni: 5,
        Juli: 6, August: 7, September: 8, Oktober: 9, November: 10, Dezember: 11
    };

    tables.each((_, table) => {
        const dateStr = $(table).find("div.bt-conference-title").text().split("(")[0].trim();
        const [day, monthName, year] = dateStr.split(" ");
        const month = months[monthName];
        const date = new Date(year, month, parseInt(day, 10));

        const rows = $(table).find("tbody > tr");
        for (let i = 1; i < rows.length - 1; i++) {
            const startRow = rows[i];
            const endRow = rows[i + 1];

            const startTimeStr = $(startRow).find('td[data-th="Uhrzeit"]').text().trim();
            const endTimeStr = $(endRow).find('td[data-th="Uhrzeit"]').text().trim();

            const [startHour, startMinute] = startTimeStr.split(":").map(Number);
            const [endHour, endMinute] = endTimeStr.split(":").map(Number);

            const startDateTime = new Date(date);
            startDateTime.setHours(startHour, startMinute);

            let endDateTimeObject = new Date(date);
            // Wenn bei der Uhrzeit eine Null an erster Stelle steht, addiere einen Tag zum End-Timestamp dazu.
            if (endHour === 0) {
                endDateTimeObject = new Date(endDateTimeObject.setDate(endDateTimeObject.getDate() + 1));
            }
            const endDateTime = endDateTimeObject;
            endDateTime.setHours(endHour, endMinute);

            let top = $(startRow).find('td[data-th="TOP"]').text().trim();
            const thema = $(startRow).find('td[data-th="Thema"] a.bt-top-collapser').text().trim();
            const beschreibungElem = $(startRow).find('td[data-th="Thema"] p');
            const beschreibung = beschreibungElem.length > 0 ? beschreibungElem.html().replace(/<br\s*\/?>/gi, "\n").replace(/<[^>]+>/g, "").trim() : "";
            const urlElem = $(startRow).find('td[data-th="Thema"] div div div button');
            const url = urlElem.length > 0 ? `https://bundestag.de${urlElem.attr("data-url")}` : "";
            const statusElem = $(startRow).find('td[data-th="Status/ Abstimmung"] p');
            const status = statusElem.length > 0 ? statusElem.html().replace(/<br\s*\/?>/gi, "\n").replace(/<[^>]+>/g, "").trim() : "";

            // PrÃ¼fen, ob "TOP" vor der Zahl steht, wenn nicht, hinzufÃ¼gen
            top = top.split(',').map(part => {
                part = part.trim();
                if (/^\d+$/.test(part)) {
                    return `TOP ${part}`;
                }
                return part;
            }).join(', ');

            const eventDescription = status ? `Status: ${status}\n\n${beschreibung}` : beschreibung;

            const agendaItem = {
                start: startDateTime.toISOString().replace(/Z/g, ''),
                end: endDateTime.toISOString().replace(/Z/g, ''),
                top: top,
                thema: thema,
                beschreibung: eventDescription,
                url: url,
                status: status,
                uid: generateUID(startDateTime, thema, top),
                dtstamp: new Date().toISOString()
            };
            agendaItems.push(agendaItem);
        }
    });

    return agendaItems;
}

// Hilfsfunktionen
function foldLine(line) {
    if (line.length <= 70) {
        return line;
    }
    let result = "";
    while (line.length > 70) {
        result += line.substring(0, 70) + "\r\n ";
        line = line.substring(70);
    }
    result += line;
    return result;
}

function createIcal(agendaItems) {
    const cal = [
        'BEGIN:VCALENDAR',
        'VERSION:2.0',
        'PRODID:-//hutt.io//api.hutt.io/bt-to//',
        'CALSCALE:GREGORIAN',
        'X-WR-TIMEZONE:Europe/Berlin',
        foldLine(`X-WR-CALNAME:Tagesordnung Bundestag`),
        foldLine(`X-WR-CALDESC:Dieses iCal-Feed stellt die aktuelle Tagesordnung des Plenums des Deutschen Bundestages zur VerfÃ¼gung. Es aktualisiert sich alle 15min selbst. Zwar ist der Sitzungsverlauf auch online unter bundestag.de/tagesordnung einsehbar, doch leider werden diese Daten nicht in einem maschinenlesbaren Format zur VerfÃ¼gung gestellt. Deshalb war es Zeit, das selbst in die Hand zu nehmen. Mehr Informationen Ã¼ber das Projekt: https://api.hutt.io/bt-to/.`),
        foldLine(`DESCRIPTION:Dieses iCal-Feed stellt die aktuelle Tagesordnung des Plenums des Deutschen Bundestages zur VerfÃ¼gung. Es aktualisiert sich alle 15min selbst. Zwar ist der Sitzungsverlauf auch online unter bundestag.de/tagesordnung einsehbar, doch leider werden diese Daten nicht in einem maschinenlesbaren Format zur VerfÃ¼gung gestellt. Deshalb war es Zeit, das selbst in die Hand zu nehmen. Mehr Informationen Ã¼ber das Projekt: https://api.hutt.io/bt-to/.`),
        'SOURCE;VALUE=URI:https://api.hutt.io/bt-to/ical',
        'COLOR:#808080',
        'X-APPLE-CALENDAR-COLOR:#808080',
        'BEGIN:VTIMEZONE',
        'TZID:Europe/Berlin',
        'BEGIN:STANDARD',
        'TZNAME:CET',
        'DTSTART:19701025T030000',
        'TZOFFSETFROM:+0200',
        'TZOFFSETTO:+0100',
        'RRULE:FREQ=YEARLY;BYMONTH=10;BYDAY=-1SU',
        'END:STANDARD',
        'BEGIN:DAYLIGHT',
        'TZNAME:CEST',
        'DTSTART:19700329T020000',
        'TZOFFSETFROM:+0100',
        'TZOFFSETTO:+0200',
        'RRULE:FREQ=YEARLY;BYMONTH=3;BYDAY=-1SU',
        'END:DAYLIGHT',
        'END:VTIMEZONE'
    ];

    const weeksWithItems = new Set();

    agendaItems.forEach(item => {
        let dtstart = new Date(item.start);
        let dtend = new Date(item.end);

        if (dtend <= dtstart) {
            dtend = new Date(dtstart.getTime() + 60000); // Add one minute
        }

        const weekNumber = getWeekNumber(dtstart);
        weeksWithItems.add(`${dtstart.getFullYear()}-${weekNumber}`);

        cal.push('BEGIN:VEVENT');
        cal.push(foldLine(`UID:${item.uid}`));
        cal.push(foldLine(`DTSTAMP:${formatDate(item.dtstamp)}`));
        cal.push(foldLine(`DTSTART;TZID=Europe/Berlin:${formatDate(item.start)}`));
        cal.push(foldLine(`DTEND;TZID=Europe/Berlin:${formatDate(item.end)}`));
        cal.push(foldLine(`SUMMARY:${item.top ? `${item.top}: ${item.thema}` : item.thema}`));
        cal.push(foldLine(`DESCRIPTION:${item.beschreibung.replace(/\n/g, '\\n')}`));
        if (item.url) {
            cal.push(foldLine(`URL:${item.url}`));
        }
        cal.push('END:VEVENT');
    });

    weeksWithItems.forEach(week => {
        const [year, weekNumber] = week.split('-');
        const monday = getMondayOfISOWeek(weekNumber, year);
        const friday = new Date(monday);
        friday.setDate(monday.getDate() + 4);

        cal.push('BEGIN:VEVENT');
        cal.push(foldLine(`UID:${generateUID(monday, 'Sitzungswoche', '')}`));
        cal.push(foldLine(`DTSTAMP:${formatDate(new Date().toISOString())}`));
        cal.push(foldLine(`DTSTART;VALUE=DATE:${formatDateOnly(monday.toISOString())}`));
        cal.push(foldLine(`DTEND;VALUE=DATE:${formatDateOnly(new Date(friday.getTime() + 24 * 60 * 60 * 1000).toISOString())}`));
        cal.push(foldLine(`SUMMARY:Sitzungswoche`));
        cal.push('END:VEVENT');
    });

    cal.push('END:VCALENDAR');

    return cal.join('\r\n');
}

function createXml(agendaItems) {
    let xml = '<?xml version="1.0" encoding="UTF-8"?>\n<agenda>\n';
    agendaItems.forEach((item) => {
        xml += "  <event>\n";
        xml += `    <start>${item.start}</start>\n`;
        xml += `    <end>${item.end}</end>\n`;
        xml += `    <top>${item.top}</top>\n`;
        xml += `    <thema>${item.thema}</thema>\n`;
        if (item.status) {
            xml += `    <status>${item.status}</status>\n`;
        }
        xml += `    <beschreibung>${item.beschreibung}</beschreibung>\n`;
        if (item.url) {
            xml += `    <url>${item.url}</url>\n`;
        }
        xml += "  </event>\n";
    });
    xml += "</agenda>";
    return xml;
}

  function createCsv(agendaItems) {
    const csvRows = [
      ["Start", "Ende", "TOP", "Thema", "Beschreibung", "URL", "Status"].map(escapeCsvValue).join(",")
    ];
    agendaItems.forEach((item) => {
      const row = [
        item.start,
        item.end,
        item.top,
        item.thema,
        item.beschreibung,
        item.url,
        item.status
      ].map(escapeCsvValue).join(",");
      csvRows.push(row);
    });
    return csvRows.join("\n");
  }

// Escapen der Daten fÃ¼r CSV-Export
function escapeCsvValue(value) {
    if (typeof value === "string") {
      value = value.replace(/"/g, '""');
      if (/[",\n]/.test(value)) {
        value = `"${value}"`;
      }
    }
    return value;
  }

// Generierung einer eindeutigen ID fÃ¼r jeden Tagesordnungspunkt
function generateUID(startDateTime, thema, top) {
    return `${startDateTime.getTime()}-${thema.replace(/\s+/g, "-").toLowerCase()}-${top.replace(/\s+/g, "-").toLowerCase()}@api.hutt.io`;
}

// Formatieren des Datums nach den Anforderungen des Kalenders
function formatDate(date) {
    return new Date(date).toISOString().replace(/[-:]/g, "").split(".")[0];
}

// Formatieren des Datums fÃ¼r getMondayOfISOWeek()
function formatDateOnly(date) {
    return date.split('T')[0].replace(/-/g, '');
}

// Ermitteln, welches Datum der Montag einer Woche hat
function getMondayOfISOWeek(week, year) {
    const simple = new Date(year, 0, 4 + (week - 1) * 7);
    const dayOfWeek = simple.getUTCDay();
    const ISOweekStart = new Date(simple);
    ISOweekStart.setUTCDate(simple.getUTCDate() - (dayOfWeek + 6) % 7);
    return ISOweekStart;
}

// Ermitteln der Kalenderwoche eines bestimmten Datums
function getWeekNumber(date) {
    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));

    d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay() || 7));

    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
    const weekNo = Math.ceil((((d - yearStart) / 86400000) + 1) / 7);

    return weekNo;
}
